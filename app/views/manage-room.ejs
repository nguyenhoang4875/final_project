<%- include('includes/header.ejs') %>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
    <script src="/library/toastr/build/toastr.min.js"></script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/user.css">
</head>
<body>
<div class="container_room">
    <div class="row">
    <div class="menu col-3 p-0 m-0">
        <div class="logo">
            <div class="pt-3">
                <div class="d-flex justify-content-center d-block">
                    <div class="d-flex align-content-center my-auto logo-img">
                        <img src="/img/avatar_default_2.png" style="width: 5rem; height: 5rem">
                    </div>
                </div>
                <div class="d-flex justify-content-center">
                    <p class="title-black d-block mx-auto mt-4">Learning Talking Community</p>
                </div>
            </div>
        </div>
        <div>
            <ul class="nav">
                <li class="nav-item d-flex flex-row justify-content-start w-100">
                    <a href="/users/all" class="nav-link fa fa-user mr-2"> <span class="mx-2"></span>
                        USERS</a>
                    <div class=""></div>
                </li>
                <li class="nav-item d-flex flex-row justify-content-start w-100 active">
                    <a href="/rooms/manages" class="nav-link fa fa-list-alt mr-2">
                        <span class="mx-2"></span>
                        ROOMS</a>
                    <!--
                                            <div class="moving-arrow"></div>
                    -->
                </li>
                <li class="nav-item d-flex flex-row justify-content-start w-100">
                    <a href="/rooms/me" class="nav-link fa fa-home mr-2">
                        <span class="mx-2"></span>
                        HOME PAGE</a>
                    <!--
                                            <div class="moving-arrow"></div>
                    -->
                </li>
                <li class="nav-item d-flex flex-row justify-content-start w-100">
                    <a href="/logout" class="nav-link fa fa-arrow-right mr-2">
                        <span class="mx-2"></span>
                        LOGOUT</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="col-9 p-0 m-0">
        <div class="global-data d-flex flex-row justify-content-center">
            <div class="global mx-2">
                <div class="global-main position-relative d-flex flex-row justify-content-between px-5 py-3"
                     style="">
                    <div class="global-icon position-absolute p-1 d-flex justify-content-center"
                         style="background-color: #28a745;">
                        <i class="fa fa-user fa-3x my-auto" style="color: #fff">
                        </i>
                    </div>
                    <p class="position-absolute align-content-center text-center" style="right: 1rem"><span
                                class="d-block title">Users</span>
                        <span class="number" style="color: #28a745"><%=totalNumUsers%></span>
                    </p>
                </div>
                <a href="/users/all">
                    <div class="global-sub d-block d-flex justify-content-between align-content-center"
                     style="background-color:#28a745;">
                        <span class="title-black">See more</span>
                        <div class="align-content-center my-auto">
                            <i class="fa fa-arrow-circle-right" style="color: #fff"></i>
                        </div>
                     </div>
                </a>
            </div>
            <div class="global mx-2">
                <div class="global-main position-relative d-flex flex-row justify-content-between px-5 py-3"
                     style="  border-color:  #efad4c;">
                    <div class="global-icon position-absolute p-1 d-flex justify-content-center"
                         style="background-color: #efad4c;">
                        <i class="fa fa-list-alt fa-3x my-auto" style="color: #fff">
                        </i>
                    </div>
                    <p class="position-absolute align-content-center text-center" style="right: 1rem"><span
                                class="d-block title">Rooms</span>
                        <span class="number" style="color: #efad4c"><%=totalNumRooms%></span>
                    </p>
                </div>
                <a href="/rooms/manages">
                    <div class="global-sub d-block d-flex justify-content-between align-content-center"
                         style="background-color: #efad4c">
                        <span class="title-black">See more</span>
                        <div class="align-content-center my-auto">
                            <i class="fa fa-arrow-circle-right"></i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="global mx-2">
                <div class="global-main position-relative d-flex flex-row justify-content-between px-5 py-3"
                     style="  border-color:#D9524F;">
                    <div class="global-icon position-absolute p-1 d-flex justify-content-center"
                         style="background-color: #D9524F;">
                        <i class="fa fa-comment fa-3x my-auto" style="color: #fff">
                        </i>
                    </div>
                    <p class="position-absolute align-content-center text-center" style="right: 1rem"><span
                                class="d-block title">Rooms online</span>
                        <span class="number" style="color: #D9524F"><%=numRoomsOnline%></span>
                    </p>
                </div>
                <div class="global-sub d-block d-flex justify-content-between align-content-center"
                     style="background-color: #D9524F">
                    <span class="title-black">See more</span>
                    <div class="align-content-center my-auto">
                        <i class="fa fa-arrow-circle-right"></i>
                    </div>
                </div>
            </div>

        </div>

        <div class="main-table">
            <div class="">
                <div class="table-title">
                    <div class="d-flex flex-row justify-content-between p-0">
                        <div class="col-sm-8 p-0">
                            <!-- Search form -->
                            <div class="input-group md-form form-sm form-2 pl-0">
                                <input id="search_input" class="form-control my-0 py-1 red-border" onchange="searchEvent()"
                                       type="text" placeholder="Search" aria-label="Search">
                                <a class="input-group-append" href="?search=" id="search_button">
                            <span class=" btn btn-success" id="basic-text1">
                             <i class="fa fa-search"></i>
                            </span>
                                </a>
                            </div>
                        </div>
                        <div class="btn btn-success" onclick="showCreateModal()">
                            <i class="fa fa-plus-circle" style="color: white"></i> New room
                        </div>
                    </div>
                </div>
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Topic</th>
                        <th>Quantity</th>
                        <th>Level</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <% if (!!data && data.status === 200) {
                    data.rooms.forEach((room, index) => { %>
                        <tr id="<%=room._id%>">
                            <td><%= index + 1 %></td>
                            <td><%= room.name %></td>
                            <td><%= room.quantity%></td>
                            <td><%= room.level%></td>
                            <td>
                                 <% if (room.status === 'active') { %>
                                    <span class="badge badge-success p-1 px-2">Active</span>
                                <% } else if (room.status === 'auth') { %>
                                    <span class="badge badge-warning p-1 px-2">Auth</span>
                                <% } else { %>
                                    <span class="badge badge-danger p-1 px-2">Full</span>
                                <% } %>
                            </td>
                            <td>
                                    <i style="cursor: pointer; color: #86BB71" class="fa fa-edit"
                                       onclick="showEditModal('<%= room._id %>')"></i>
                            </td>
                        </tr>
                    <% })%>
                    <% } else { %>
                        <div> Rooms Empty</div>
                    <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    </div>
</div>

<!-- Modal edit and create -->
<div
        class="modal fade"
        id="form_room"
        tabindex="-1"
        role="dialog"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header border-bottom-0">
                <h5 class="modal-title" id="modalHeader">Create Account</h5>
                <button
                        type="button"
                        id="closeBtn"
                        class="close"
                        data-dismiss="modal"
                        aria-label="Close"
                >
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="topic">Topic</label>
                        <input type="text" class="form-control" name="topic" placeholder="Any topic"/>
                    </div>
                    <div class="form-group">
                        <label for="selectMaxPeople">Maximum peoples</label>
                        <select class="form-control" id="selectMaxPeople" name="quantity">
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="selectLevels">Level</label>
                        <select class="form-control" id="selectLevels" name="level">
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="text" class="form-control" name="password" placeholder=""/>
                    </div>
                    <input type="hidden" name="room_id"/>
                </div>

                <div class="modal-footer border-top-0 d-flex">
                    <button
                            type="button"
                            class="btn btn-danger"
                            style="margin-right: 52%"
                            id="delete_room"
                    >
                        Delete
                    </button>
                    <div class="justify-content-end">
                        <button type="submit" class="btn btn-success" id="submit_room">Submit</button>
                        <button
                                type="button"
                                class="btn btn-secondary"
                                data-dismiss="modal"
                                aria-label="Close"
                                id="cancel_room"
                        >
                            Close
                        </button>
                    </div>
                </div>
        </div>
    </div>
</div>
<!-- Modal edit -->

</div>

<%- include('includes/end.ejs') %>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="/js/manage-room.js"></script>
</html>
